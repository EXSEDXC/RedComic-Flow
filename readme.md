# XHS-Auto-Flow: 小红书自动化全链路控制台

本项目是一款专为内容创作者设计的全链路自动化工具，集成 **笔记采集、AI 视觉识别过滤、文案深度改写、批量定时发布** 等功能。通过可视化 Pygame 控制台，用户可以轻松管理从素材搜集到账号运营的完整闭环。

## 📸 核心工作流图解

---

## 🚀 核心模块说明

1. **可视化控制台 (`main_dashboard.py`)**
* 提供搜索词、采集上限、发布间隔等参数的实时配置。
* 集成多线程运行机制，确保 GUI 界面在后台脚本执行时不卡顿。
* 包含实时的日志系统，追踪每一个任务的执行状态。


2. **智能视觉识别爬虫 (`spider.py`)**
* **深度过滤**：调用阿里云百炼 `qwen-vl-plus` 模型，自动分析笔记图片是否符合“六格漫画”标准，非标准内容自动跳过且不计入统计。
* **自动化绕过**：基于 `DrissionPage` 驱动，有效隐藏自动化特征，降低封禁风险。
* **精准存储**：采集成功的笔记按序号存储于 `RedComic_Final_Fixed` 文件夹，并自动清理下载失败的残留空目录。



---

## ⚠️ 关键操作规范 (发布流程必读)

本项目采用“采集与发布解耦”的设计思路，以确保发布内容的质量。执行发布前必须完成以下步骤：

### 第一步：准备 `images` 文件夹

程序**不会**自动将采集到的所有图片搬运到发布库。你需要：

1. 在根目录下手动新建名为 `images` 的文件夹。
2. 从 `RedComic_Final_Fixed` 中筛选你满意的笔记素材。

### 第二步：严格的命名协议

**批量发布脚本** 严格依赖文件名顺序进行多图上传。请确保 `images` 文件夹内的图片命名如下：

* ✅ **正确顺序**：`1.jpg`, `2.jpg`, `3.jpg`, `4.jpg` ...
* ❌ **错误命名**：`note1.jpg`, `cover.jpg` 或不连续的数字。

> **提示**：图片顺序将直接决定小红书笔记轮播图的展示顺序。

---

## 🛠️ 环境搭建与配置

### 1. 基础环境

* **Python**: 推荐 3.9 或以上版本。
* **浏览器**: 本项目使用本地 Chrome。请确保你的 Chrome 浏览器已安装。

### 2. 安装依赖

```bash
pip install -r requirements.txt

```

### 3. API 密钥配置 (敏感信息保护)

在项目根目录新建 `.env` 文件，并填入你的百炼 API Key：

```env
# 阿里云百炼 API 密钥
DASHSCOPE_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

```

---

## 📖 详细使用指南

1. **启动控制台**：
运行 `python main_dashboard.py`，进入可视化界面。
2. **参数设定**：
* 在输入框填写你要搜索的**关键词**。
* 设定**有效采集数量**（例如 10，则程序会持续寻找直到找到 10 个符合 AI 过滤标准的笔记）。


3. **开启 AI 过滤**：
点击界面上的 **“Qwen 视觉过滤”** 按钮。当颜色变亮时，表示已激活大模型识别逻辑。
4. **执行采集**：
点击按钮 **“1. 采集 (Spider)”**。采集完成后，数据将出现在 `RedComic_Final_Fixed`。
5. **素材中转**：
手动挑选图片移入 `images` 文件夹，并完成 `1.jpg` 顺序重命名。
6. **改写与发布**：
依次点击 **“2. AI 文案改写”** 和 **“3. 批量自动发布”**。

---

## 📂 项目目录结构

```text
.
├── .env                     # [必须创建] 存放 API 密钥
├── app_config.json          # [自动生成] 记录 GUI 参数配置
├── main_dashboard.py        # 控制台入口
├── spider.py                # 爬虫逻辑 (含 AI 视觉过滤)
├── images/                  # [必须手动创建] 用于存放当前准备发布的图片
├── RedComic_Final_Fixed/    # 爬虫输出目录 (原始素材)
│   ├── note_1/
│   ├── note_2/
│   └── metadata.csv         # 采集到的笔记元数据
└── requirements.txt         # 项目依赖清单

```

## 🐞 常见问题排查 (Troubleshooting)

* **界面显示乱码？**
* 程序会自动匹配系统自带的中文字体（微软雅黑、黑体等）。若仍乱码，请检查 `main_dashboard.py` 中 `load_system_font` 的字体列表。


* **AI 识别一直提示“否”？**
* 请检查 `.env` 文件中的 Key 是否正确，以及网络能否访问 `dashscope.aliyuncs.com`。


* **浏览器启动失败？**
* 请关闭所有已手动打开的 Chrome 窗口，或在 `ChromiumOptions` 中设置独立的用户数据目录。



---

## 📜 免责声明

本工具仅供学习、研究使用，请勿用于任何商业用途或非法采集。使用本程序爬取数据需遵守目标平台的 Robots 协议。因使用本程序造成的账号封禁或法律风险，由使用者自行承担。
